# BBS 社区功能更新总结

## 📝 更新内容

已将完整的 BBS（轻社交）功能集成到 PRD v2.0 增强版，涵盖以下核心内容：

### 1. 社区定位与用户价值 (4.6.1-4.6.2)
- **定位**：轻社交内容平台
- **用户**：患者、家属、康复患者
- **核心价值**：同伴支持、经验聚合、心理支持

### 2. 内容规范 (4.6.3)
- **允许发布**：6 大类内容（就诊经验、心理支持、生活经验、成就展示、患者故事、科普讨论）
- **禁止发布**：6 大禁区（诊疗建议、用药讨论、治疗推荐、商业推广、人身攻击、医疗欺诈）
- **防御机制**：系统自动过滤 + 人工审核双层防护

### 3. 用户身份与等级系统 (4.6.4)
- **4 种身份标签**：患者、家属、医生、版主
- **10 级等级系统**：
  - L1-3：新手（先审后发，5 帖/日）
  - L4-7：活跃（先发后审，10 帖/日）
  - L8-10：贡献者 VIP（不审，无限发）
- **等级提升条件**：赞数、评论数、无违规天数
- **等级下降触发**：违规、被举报

### 4. 审核工作流 (4.6.5)
- **SLA 承诺**：4h 内回复（工作日）
- **3 种审核结果**：已通过 ✓、待审核 ⏳、已拒绝 ✗
- **4 类拒绝原因**：医学讨论、商业推广、人身攻击、其他

### 5. 帖子结构设计 (4.6.6)
- **发布者信息**：头像、昵称、身份标签、等级徽章
- **帖子内容**：标题、正文、配图（≤4张）、标签（≤3个）
- **审核信息**：审核状态、发布时间、更新时间
- **互动数据**：评论、点赞、浏览、分享、举报（版主可见）
- **6 类预设标签**：就诊体验、心理支持、生活经验、勋章展示、患者故事、科普讨论

### 6. 评论系统 (4.6.7)
- **嵌套结构**：一级评论 ↔ 二级回复（不支持三级）
- **字数限制**：一级 500 字，二级 300 字
- **交互功能**：点赞、举报、@提及

### 7. 安全与危机预警 (4.6.8) ⭐
- **AI 自动检测**：3 类关键词（诊疗、危机、推广）
- **危机干预**：
  - 自动触发弹窗
  - 提供援助链接（心理热线、医生、资源库）
  - 通知审核员和医学顾问
- **一键举报**：用户可举报不当内容，5 类原因选择
- **风险分级**：低/中/高/极高 4 个等级

### 8. 分享奖励机制 (4.6.9)
- **帖子分享**：+5 AI 配额，每日最多 2 次（+10）
- **评论分享**：高质量评论（赞 ≥20）可被推荐分享
- **验证方式**：72h 内链接点击确认
- **分享卡片**：含二维码、标题、摘要、等级信息

### 9. 运营看板 (4.6.10)
- **指标监控**：发帖量、评论量、举报数、审核耗时
- **内容分析**：违规分布、危机命中次数、高活跃用户
- **版主可见**：举报数、用户排行

### 10. 处罚体系 (4.6.11)
- **分级处罚**：
  - 首次：删除 + 警告 - 1 Level
  - 二次：删除 - 3 Level + 3 天禁言
  - 三次：删除 - 5 Level + 7 天禁言
  - 多次：永久禁言
- **申诉机制**：24h 内版主回复

---

## 📊 数据模型扩展

新增 7 张表支持 BBS 功能：

| 表名 | 用途 | 关键字段 |
|------|------|--------|
| `community_posts` | 帖子主表 | title, content, images, tags, audit_status, 统计数据 |
| `community_comments` | 评论表 | post_id, parent_comment_id, content, audit_status |
| `community_likes` | 点赞表 | user_id, post_id/comment_id |
| `community_reports` | 举报表 | reporter_id, post_id/comment_id, reason, status |
| `user_level` | 用户等级 | community_level (1-10), post_count, violation_count, is_banned |
| `community_shares` | 分享奖励 | user_id, post_id, quota_rewarded, share_verified |
| （帖子表扩展） | - | title, images, tags, reject_reason, 5 类统计数据 |

---

## 🎨 UI 设计规范已完成

详见 **DESIGN_SYSTEM_AND_UI_SPEC_V1.0.md** 中的：
- 7.5 社区讨论页面（Community / BBS）
  - BBS 列表（推荐/最新/热门/我的）
  - 帖子卡片设计（审核标记、用户身份、等级）
  - 发布帖子表单
  - 帖子详情 & 评论页面
  - 审核标记样式（绿/黄/红色）
  - 用户身份标签配色
  - 等级徽章（灰/绿/金）

---

## ✅ 集成关键点

1. **配额系统关联**：社区分享可赚 AI 配额（+5 每次）
2. **游戏化关联**：完成关卡可在社区展示勋章
3. **安全合规**：AI 自动过滤 + 医学顾问审核
4. **隐私保护**：危机信息加密存储、脱敏处理
5. **用户激励**：等级系统、分享奖励、被分享徽章

---

## 🚀 开发建议

### 前端优先级
1. BBS 列表页面
2. 发布帖子表单
3. 帖子详情 & 评论
4. 审核状态展示
5. 危机救助按钮（固定顶部）

### 后端优先级
1. 表结构初始化（7 张新表）
2. 帖子 CRUD API
3. 审核工作流 API
4. 关键词检测 + AI 集成
5. 分享验证 & 奖励逻辑

### 监管建议
1. 准备「社区规范」文档
2. 医学顾问委员会审核流程
3. 危机干预 SOP
4. 举报处理流程文档

---

**更新时间**：2025-12-25  
**文档版本**：v2.0  
**状态**：✅ 完成（可开发）
